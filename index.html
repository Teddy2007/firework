<!DOCTYPE html>
<!-- 声明文档类型为HTML5，这是所有HTML页面的第一行，告诉浏览器用HTML5规则解析页面 -->
<html lang="zh-CN">
<!-- html根标签，包裹整个页面内容，lang="zh-CN"表示页面语言是简体中文 -->
<head>
    <!-- head标签：存放页面的配置信息（不显示在页面上），比如编码、标题、样式等 -->
    <meta charset="UTF-8">
    <!-- meta标签：设置页面字符编码为UTF-8（支持中文，避免乱码） -->
    <!-- 关键的手机适配配置：
         width=device-width：页面宽度等于设备屏幕宽度
         initial-scale=1.0：初始缩放比例为1（不缩放）
         user-scalable=no：禁止用户手动缩放页面（避免手机上放大/缩小影响效果）
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <!-- title标签：页面标题（QQ打开时顶部会显示，浏览器标签页也会显示） -->
    <title>手机烟花特效</title>
    <!-- style标签：存放CSS样式（控制页面元素的外观、位置） -->
    <style>
        /* 通配符选择器：选中页面所有元素，统一初始化样式 */
        * {
            margin: 0;        /* 清除所有元素默认的外边距 */
            padding: 0;       /* 清除所有元素默认的内边距 */
            box-sizing: border-box; /* 让元素的宽高包含边框和内边距（方便计算尺寸） */
        }
        /* body选择器：选中页面的body标签（页面的主体内容容器） */
        body {
            width: 100vw;     /* 宽度等于屏幕宽度（vw是视口宽度单位，1vw=屏幕宽度的1%） */
            height: 100vh;    /* 高度等于屏幕高度（vh是视口高度单位，1vh=屏幕高度的1%） */
            background: #000; /* 背景色设为黑色（黑色背景烟花效果更明显） */
            overflow: hidden; /* 隐藏超出屏幕的内容（防止出现滚动条） */
            touch-action: none; /* 禁止手机触摸的默认行为（比如滑动、缩放，避免干扰点击烟花） */
        }
        /* 类选择器：选中所有class="particle"的元素（烟花粒子） */
        .particle {
            position: absolute; /* 绝对定位：可以自由设置元素的坐标（left/top） */
            border-radius: 50%; /* 圆角设为50%：让粒子变成圆形（烟花粒子都是圆点） */
            opacity: 1;         /* 初始透明度1（完全不透明） */
            pointer-events: none; /* 粒子不阻挡点击事件（避免点到粒子没反应） */
        }
    </style>
</head>
<body>
    <!-- body标签：页面的可见内容都放在这里，这里只有JS代码（控制交互和动画） -->
    <script>
        // ===================== 配置参数区（你可以直接修改这里的值调整效果） =====================
        // 用const定义常量对象config，存放所有可配置的参数（方便修改，不用改核心逻辑）
        const config = {
            autoFireRate: 1200, // 自动放烟花的间隔时间（单位：毫秒），5000=5秒（数值越大频率越低）
            particleCount: 80,   // 每个烟花爆炸的粒子数量（数值越大烟花越密）
            particleSpeed: 3,    // 粒子爆炸的初始速度（数值越大粒子飞越快）
            fireSpeed: 5,        // 烟花从底部升空的速度（数值越大升空越快）
            // 烟花粒子的颜色数组（随机选一个颜色，可自行添加/删除颜色）
            colors: ['#ff0000', '#ff9900', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#9900ff', '#ff00ff']
        };

        // ===================== 页面初始化（页面加载完成后执行） =====================
        // window.onload：页面所有内容加载完成后执行的函数（确保代码能找到页面元素）
        window.onload = function() {
            // setInterval：定时重复执行函数，第一个参数是要执行的函数，第二个是间隔时间（毫秒）
            // 这里是启动自动放烟花，每隔config.autoFireRate（5秒）执行一次autoFirework函数
            setInterval(autoFirework, config.autoFireRate);

            // 监听页面的点击事件：鼠标点击页面任意位置时，执行fireworkAtPosition函数
            document.addEventListener('click', fireworkAtPosition);

            // 监听手机的触摸事件（适配手机点击）：手指触摸屏幕时执行
            document.addEventListener('touchstart', function(e) {
                e.preventDefault(); // 阻止触摸的默认行为（比如手机滑动页面、放大缩小）
                const touch = e.touches[0]; // 获取第一个触摸点的信息（手指位置）
                // 调用放烟花函数，把触摸点的坐标传过去（模拟点击）
                fireworkAtPosition({ clientX: touch.clientX, clientY: touch.clientY });
            });
        };

        // ===================== 自动放烟花函数（目标位置随机） =====================
        function autoFirework() {
            // 随机生成目标X坐标：0到屏幕宽度之间的随机数（横向随机）
            const targetX = Math.random() * window.innerWidth;
            // 随机生成目标Y坐标：0到屏幕高度60%之间的随机数（限制在上半部分，更符合视觉习惯）
            const targetY = (Math.random() *0.6 + 0.08)* window.innerHeight;
            // 调用创建烟花的函数，传入随机目标坐标
            createFirework(targetX, targetY,0);
        }

        // ===================== 点击/触摸位置放烟花函数 =====================
        // e是事件对象，包含点击/触摸的坐标（clientX=横向坐标，clientY=纵向坐标）
        function fireworkAtPosition(e) {
            // 调用创建烟花的函数，传入点击/触摸的坐标
            createFirework(e.clientX, e.clientY,1);
        }

        // ===================== 核心：创建烟花（从底部升空到目标位置） =====================
        // targetX：烟花要飞到的横向目标坐标，targetY：纵向目标坐标
        function createFirework(targetX, targetY, flag) {
            // 烟花升空的起点坐标（从底部出发）
            // startX：底部居中，左右随机偏移±50px（避免每次都从正中间起飞）
            //const startX = window.innerWidth / 2 + (Math.random() - 0.5) * 100;
            const startX = targetX;
            const startY = window.innerHeight; // startY：屏幕最底部（window.innerHeight是屏幕高度）

            // 1. 创建烟花升空的“引线光点”（就是从底部飞上去的那个小白点）
            const trail = document.createElement('div'); // 创建一个新的div元素
            trail.className = 'particle'; // 给这个div加class="particle"（应用前面定义的粒子样式）
            trail.style.width = '6px';    // 光点宽度4px
            trail.style.height = '6px';   // 光点高度4px
            trail.style.backgroundColor = '#fff'; // 光点颜色白色
            trail.style.left = `${startX}px`; // 初始横向位置（起点X）
            trail.style.top = `${startY}px`;  // 初始纵向位置（起点Y）
            document.body.appendChild(trail); // 把光点添加到页面上（才能看到）

            // 2. 计算烟花升空的方向和步长（每帧移动的距离）
            const dx = targetX - startX; // 横向需要移动的总距离（目标X - 起点X）
            const dy = targetY - startY; // 纵向需要移动的总距离（目标Y - 起点Y）
            // 计算起点到目标的直线距离（勾股定理：a²+b²=c²）
            const distance = Math.sqrt(dx * dx + dy * dy);
            // 横向每帧移动的距离：总横向距离 / 总距离 * 升空速度（保证速度均匀）
            const stepX = (dx / distance) * config.fireSpeed;
            // 纵向每帧移动的距离：总纵向距离 / 总距离 * 升空速度
            const stepY = (dy / distance) * config.fireSpeed;

            // 3. 实现烟花升空的动画（用setInterval定时更新位置）
            // setInterval返回一个定时器ID，用于后续停止定时器
            const moveInterval = setInterval(() => {
                // 获取当前光点的位置（parseFloat把字符串转成数字，比如"100px"转成100）
                let currentX = parseFloat(trail.style.left);
                let currentY = parseFloat(trail.style.top);

                // 判断是否到达目标位置：当前位置和目标位置的距离小于10px时，认为到达
                if (Math.sqrt((currentX - targetX) **2 + (currentY - targetY)** 2) < 10) {
                    clearInterval(moveInterval); // 停止升空动画
                    document.body.removeChild(trail); // 移除升空的光点（已经到目标位置，不需要了）
                    createExplosion(targetX, targetY); // 调用爆炸函数，在目标位置生成烟花爆炸效果
                    return; // 结束当前函数，不再执行后面的代码
                }

                // 更新光点位置（每帧移动一步）
                if(flag == 1){
                    trail.style.left = `${currentX + stepX*1.6}px`;
                    trail.style.top = `${currentY + stepY*1.6}px`;
                }else{
                    trail.style.left = `${currentX + stepX}px`;
                    trail.style.top = `${currentY + stepY}px`;
                }
                
            }, 16); // 每16毫秒执行一次（1秒=1000毫秒，1000/16≈60帧/秒，动画更流畅）
        }

        // ===================== 烟花爆炸效果（生成彩色粒子） =====================
        // x：爆炸的横向坐标，y：爆炸的纵向坐标
        function createExplosion(x, y) {
            // 循环创建多个粒子（数量由config.particleCount决定，默认80个）
            for (let i = 0; i < config.particleCount; i++) {
                // 1. 创建单个粒子
                const particle = document.createElement('div');
                particle.className = 'particle'; // 应用粒子样式

                // 随机设置粒子大小：2px到6px之间（Math.random()生成0-1的随机数）
                const size = Math.random() * 4 + 2;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;

                // 随机选择颜色：从config.colors数组中选一个
                particle.style.backgroundColor = config.colors[Math.floor(Math.random() * config.colors.length)];

                // 粒子初始位置：爆炸的中心坐标（x,y）
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                document.body.appendChild(particle); // 添加到页面上

                // 2. 计算粒子爆炸的方向和速度（随机角度）
                const angle = Math.random() * Math.PI * 2; // 随机角度（0到360度，用弧度表示）
                const speed = Math.random() * config.particleSpeed + 1; // 随机速度（1到4之间）
                // 横向速度：cos(角度) * 速度（三角函数计算水平方向分量）
                const vx = Math.cos(angle) * speed;
                // 纵向速度：sin(角度) * 速度（三角函数计算垂直方向分量）
                const vy = Math.sin(angle) * speed;

                // 3. 粒子动画（移动+淡出）
                let opacity = 1; // 初始透明度1（完全不透明）
                const particleInterval = setInterval(() => {
                    // 获取粒子当前位置
                    let currentX = parseFloat(particle.style.left);
                    let currentY = parseFloat(particle.style.top);

                    // 更新粒子位置（每帧移动）
                    currentX += vx; // 横向移动
                    currentY += vy + 0.2; // 纵向移动（+0.1是模拟重力，粒子会轻微下落，更真实）

                    // 更新透明度（每帧降低0.01，慢慢消失）
                    opacity -= 0.02;

                    // 应用新的位置和透明度
                    particle.style.left = `${currentX}px`;
                    particle.style.top = `${currentY}px`;
                    particle.style.opacity = opacity;

                    // 当透明度≤0时，移除粒子（避免页面元素过多，影响性能）
                    if (opacity <= 0) {
                        clearInterval(particleInterval); // 停止粒子动画
                        document.body.removeChild(particle); // 从页面移除粒子
                    }
                }, 16); // 60帧/秒，保证动画流畅
            }
        }
    </script>
</body>
</html>